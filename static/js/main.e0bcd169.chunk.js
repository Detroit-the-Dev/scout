(this["webpackJsonpnew-york-open-data-explorer"]=this["webpackJsonpnew-york-open-data-explorer"]||[]).push([[0],{28:function(e,t,a){},47:function(e,t,a){e.exports=a(96)},54:function(e,t,a){},64:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(38),l=a.n(r),o=(a(52),a(53),a(54),a(7)),i=a(14),s=a(20),u=a(1),m=(a(64),a(6)),d=a(5),E=a(4),p=a(22),f=a.n(p),v=a(2),b=a(23),h=a(12),O=a(13),g=a.n(O),j="https://api.us.socrata.com/api/catalog/v1?domains=data.cityofnewyork.us&search_context=data.cityofnewyork.us";function y(e){var t,a=arguments;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:100,n.abrupt("return",fetch("".concat(j,"&offset=").concat(e*t,"&limit=").concat(t)).then((function(e){return e.json()})));case 2:case"end":return n.stop()}}))}function C(e){return new Set([].concat(Object(E.a)(e.resource.columns_name.map((function(e){return e.toLocaleLowerCase()}))),Object(E.a)(e.resource.columns_field_name.map((function(e){return e.toLocaleLowerCase()})))))}function N(e,t){var a=C(t),n=new Set(Object(E.a)(e).filter((function(e){return a.has(e)})));return Array.from(n)}function T(e,t){return fetch("https://data.cityofnewyork.us/resource/".concat(e.resource.id,".json?$select=distinct ").concat(t.replace(/ /g,"_"))).then((function(e){return e.json()})).then((function(a){return a.errorCode||a.error?(console.warn("Failed to load unique entries for dataset ",e," column ",t),[]):a.map((function(e){return Object.values(e)[0]}))}))}var w=new b.a("SocrataCache");w.version(1).stores({SocrataCache:"id"});var S=Object(n.createContext)(),_={datasets:[],tagList:[],categories:[],departments:[],columns:[],stateLoaded:!1},k=function(e,t){var a=t.type,n=t.payload;switch(a){case"UPDATE_OPEN_DATASET_MANIFEST":return Object(v.a)({},e,{datasets:n});case"UPDATE_TAGS":return Object(v.a)({},e,{tagList:n});case"UPDATE_CATEGORIES":return Object(v.a)({},e,{categories:n});case"UPDATE_COLUMNS":return Object(v.a)({},e,{columns:n});case"UPDATE_DEPARTMENTS":return Object(v.a)({},e,{departments:n});case"HYDRATE_STATE":return Object(v.a)({},e,{},n);case"SET_LOADED":return Object(v.a)({},e,{stateLoaded:!0});default:return e}},A=function(){return Object(n.useContext)(S)};function D(){var e=A();return Object(u.a)(e,1)[0].stateLoaded}function L(e){var t=A(),a=Object(u.a)(t,1)[0].datasets;return Object(n.useMemo)((function(){return e?function(e,t){var a=C(e);return t.map((function(e){return{dataset:e,joinableColumns:N(a,e)}})).filter((function(t){return t.joinableColumns.length>0&&t.dataset.resource.id!==e.resource.id}))}(e,a):[]}),[e,a])}function R(e){var t=A();return Object(u.a)(t,1)[0].datasets.find((function(t){return t.resource.id===e}))}function x(e){var t=A(),a=Object(u.a)(t,1)[0].datasets;return Object(n.useMemo)((function(){return a.filter((function(t){return e.includes(t.resource.id)}))}),[a,e])}var I=a(32),M=a.n(I),F=Object(n.createContext)(),P={collections:[{id:"pending",datasets:[],name:"pending"}],activeCollectionID:"pending"},U=new b.a("CollectionCache");U.version(1).stores({CollectionCache:"id"});var V=function(e,t){var a=t.type,n=t.payload;switch(a){case"CREATE_COLLECTION_FROM_PENDING":return Object(v.a)({},e,{collections:[].concat(Object(E.a)(e.collections),[Object(v.a)({},e.collections.find((function(e){return"pending"===e.id})),{id:M()(),name:n.name})]).map((function(e){return"pending"===e.id?{id:"pending",datasets:[],name:"pending"}:e}))});case"ADD_TO_COLLECTION":return Object(v.a)({},e,{collections:e.collections.map((function(e){return e.id===n.id?Object(v.a)({},e,{datasets:[].concat(Object(E.a)(e.datasets),[n.datasetID])}):e}))});case"REMOVE_FROM_COLLECTION":return Object(v.a)({},e,{collections:e.collections.map((function(e){return e.id===n.id?Object(v.a)({},e,{datasets:e.datasets.filter((function(e){return e!==n.datasetID}))}):e}))});case"SET_NAME":return Object(v.a)({},e,{collections:[].concat(Object(E.a)(e),[e.collections.map((function(e){return e.id===n.id?Object(v.a)({},e,{name:n.name}):e}))])});case"CLEAR_COLLECTION":return Object(v.a)({},e,{collections:[].concat(Object(E.a)(e),[e.collections.map((function(e){return e.id===n.id?Object(v.a)({},e,{datasets:[]}):e}))])});case"DELETE_COLLECTION":return Object(v.a)({},e,{collections:e.collections.filter((function(e){return e.id!==n.id}))});case"CREATE_COLLECTION":return Object(v.a)({},e,{collections:[].concat(Object(E.a)(e.collections),[Object(v.a)({},n,{id:M()()})])});case"HYDRATE_STATE":return Object(v.a)({},e,{},n);default:return e}},W=function(){return Object(n.useContext)(F)};function G(){var e=W(),t=Object(u.a)(e,2),a=t[0],n=t[1],c=a.activeCollectionID,r=a.pendingCollection;return[c?a.collections.find((function(e){return e.id===a.activeCollectionID})):r,{clearCollection:function(e){n({type:"CLEAR_COLLECTION",payload:{id:e}})},addToCollection:function(e,t){n({type:"ADD_TO_COLLECTION",payload:{id:e,datasetID:t}})},removeFromCollection:function(e,t){return n({type:"REMOVE_FROM_COLLECTION",payload:{id:e,datasetID:t}})},setName:function(e,t){return n({type:"SET_NAME",payload:{id:t,name:e}})},createCollectionFromPending:function(e){n({type:"CREATE_COLLECTION_FROM_PENDING",payload:{name:e}})}}]}var B=a(41),Y=a.n(B);function q(e){var t=e.html,a=e.className,n=Y.a.sanitize(t);return c.a.createElement("div",{className:a,dangerouslySetInnerHTML:{__html:n}})}function z(e,t){if(t){var a=new RegExp("(".concat(t,")"),"ig");return c.a.createElement(q,{html:e.replace(a,(function(e){return'<span class="hilight">'.concat(e,"</span>")}))})}return e}function H(e){return"/collection/".concat(e.name,"/").concat(e.datasets.join(","))}a(70);function J(e){var t=e.visible,a=function(){var e=W();return Object(u.a)(e,1)[0]}(),r=G(),l=Object(u.a)(r,2),i=l[0],s=l[1],m=s.removeFromCollection,d=s.createCollectionFromPending,E=x(i.datasets),p=Object(n.useState)(""),f=Object(u.a)(p,2),v=f[0],b=f[1],h=Object(n.useState)("new"),O=Object(u.a)(h,2),g=O[0],j=O[1],y=Object(n.useState)(!1),C=Object(u.a)(y,2),N=C[0],T=C[1],w=function(e){var t,a;return null===e||void 0===e?void 0:null===(t=e.classification.domain_metadata)||void 0===t?void 0:null===(a=t.find((function(e){return"Dataset-Information_Agency"===e.key})))||void 0===a?void 0:a.value};return t?c.a.createElement("div",{className:"collection-tab"},N?c.a.createElement("div",{className:"collections-tab-create"},c.a.createElement("h2",null,"Create Collection"),c.a.createElement("div",{className:"collections-tab-create-options"},c.a.createElement("p",null,"Name your new collection"),c.a.createElement("input",{placeholder:"name",type:"text",value:v,onChange:function(e){return b(e.target.value)}}),c.a.createElement("ul",null,E.map((function(e){return c.a.createElement("li",{className:"collection-tab-dataset"},c.a.createElement("div",null,c.a.createElement("p",{className:"name"},e.resource.name),c.a.createElement("p",{className:"agency"}," ",w(e))))})))),c.a.createElement("div",{className:"collection-tab-buttons"},c.a.createElement("button",{type:"submit",onClick:function(){d(v),T(!1)}},"Create"),c.a.createElement("button",{type:"button",onClick:function(){return T(!1)}},"Cancel"))):c.a.createElement("div",{className:"collections-tab-view"},c.a.createElement("h2",null,"Collections"),c.a.createElement("div",{className:"collection-tab-tabs"},c.a.createElement("button",{type:"button",onClick:function(){return j("new")},className:"header-button' ".concat("new"===g?"selected":"")},"Create new"),c.a.createElement("button",{type:"button",onClick:function(){return j("existing")},className:"header-button' ".concat("existing"===g?"selected":"")},"Existing Collections")),"new"===g&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"collection-tab-current-collection"},0===E.length?c.a.createElement("div",{className:"datasets-placeholder"},c.a.createElement("h3",null,"No datasets selected"),c.a.createElement("p",null,'Select `"`Add to Collection`"` to begin creating local collections.')):c.a.createElement("ul",null,E.map((function(e){return c.a.createElement("li",{key:e.resource.name,className:"collection-tab-dataset"},c.a.createElement("div",null,c.a.createElement("p",{className:"name"},e.resource.name),c.a.createElement("p",{className:"agency"},w(e))),c.a.createElement("button",{type:"button",onClick:function(){return m(i.id,e.resource.id)}},"Remove"))})))),c.a.createElement("div",{className:"collection-tab-buttons"},c.a.createElement("button",{type:"submit",onClick:function(){return T(!0)}},"Create Collection"))),"existing"===g&&c.a.createElement("div",{className:"collections-tab-existing-collections"},1===a.collections.length?c.a.createElement("div",{className:"datasets-placeholder"},c.a.createElement("h3",null,"No collections yet")):c.a.createElement("ul",{className:"existing-collections-list"},a.collections.filter((function(e){return"pending"!==e.id})).map((function(e){return c.a.createElement("li",{className:"existing-collection"},c.a.createElement("div",{className:"exisiting-colections-deets"},c.a.createElement("p",{className:"name"},e.name),c.a.createElement("p",{className:"dataset-count"}," ",e.datasets.length," datasets"," ")),c.a.createElement(o.Link,{to:H(e)},"View"))})))))):""}function K(){var e=window.location.href;console.log("location ",e);var t=Object(n.useState)(!1),a=Object(u.a)(t,2),r=a[0],l=a[1],i=G(),s=Object(u.a)(i,1)[0];return c.a.createElement("nav",{className:"side-nav"},c.a.createElement(o.Link,{alt:"Data Clinic",className:"title",to:"/"},c.a.createElement("h2",{className:"scout-h2"},"Scout"),c.a.createElement("p",{className:"scout-sub"},"by data clinic")),c.a.createElement(o.NavLink,{activeClassName:"active-nav",alt:"Explore",className:"explore",exact:!0,to:"/"},c.a.createElement(m.a,{size:"2x",icon:d.f}),c.a.createElement("h1",null,"Explore")),c.a.createElement("div",{style:{position:"relative"}},s.datasets.length>0&&c.a.createElement("div",{className:"collection-counter"},s.datasets.length),c.a.createElement("button",{onClick:function(){return l(!r)},type:"button",className:"header-button"},c.a.createElement(m.a,{size:"2x",icon:d.d}),c.a.createElement("h1",null,"Collections")),c.a.createElement(J,{visible:r})),c.a.createElement(o.NavLink,{exact:!0,activeClassName:"active-nav",alt:"about",className:"about",to:"/about"},c.a.createElement(m.a,{size:"2x",icon:d.g}),c.a.createElement("h1",null,"About Data Clinic")))}a(71);var $=a(42),Q=(a(74),function(e){var t=e.permalink;return c.a.createElement("a",{className:"external-link",target:"_blank",rel:"noopener noreferrer",href:t},c.a.createElement("button",{type:"button"},"View on Open Data\xa0",c.a.createElement(m.a,{icon:d.e})))});function X(e){var t,a=e.dataset,n=e.onAddToCollection,r=e.onRemoveFromCollection,l=e.inCollection,i=e.viewInOpenPortal,s=void 0!==i&&i,u=e.similarity,m=e.query,d=z(a.resource.name,m),E=z(a.resource.description,m);return c.a.createElement("div",{className:"dataset",key:a.resource.id},c.a.createElement("div",{className:"dataset-title"},c.a.createElement("p",null,a.resource.attribution),c.a.createElement(o.Link,{className:"title",to:"/dataset/".concat(a.resource.id)},c.a.createElement("h2",null,d))),n&&c.a.createElement("button",{type:"button",onClick:function(){return l?r(a.resource.id):n(a.resource.id)}},l?"Remove from collection":"Add to collection"),u&&c.a.createElement("p",{className:"similarity"},c.a.createElement("p",{className:"header"},"Similarity"),c.a.createElement("p",null,(100*u).toPrecision(2),"%")),s&&c.a.createElement(Q,{permalink:a.permalink}),c.a.createElement("div",{className:"dataset-join-thematic"},c.a.createElement("p",{className:"header"},"Last Updated"),c.a.createElement("p",null,"33")),c.a.createElement("div",{className:"dataset-description"},E),c.a.createElement("div",{className:"dataset-meta"},c.a.createElement("div",{className:"update-frequency"},c.a.createElement("span",null,"Update frequency:"),"weekly"),c.a.createElement("div",{className:"dataset-last-updated"},c.a.createElement("span",null,"Last Update at:"),(t=a.resource.updatedAt,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})))))}a(75);function Z(e){var t=e.options,a=e.selected,r=e.direction,l=e.onSelected,o=e.onDirection,i=Object(n.useState)(!1),s=Object(u.a)(i,2),E=s[0],p=s[1];return c.a.createElement("div",{className:"sort-menu ".concat(E?"expanded":"")},c.a.createElement("div",{className:"wrapper"},c.a.createElement("span",null,"Sort By:"),c.a.createElement("ul",null,c.a.createElement("li",{onClick:function(){return p(!E)}},a),t.filter((function(e){return e!==a})).map((function(e){return c.a.createElement("li",{onClick:function(){l(e),p(!1)},key:e},e," ")}))),c.a.createElement(m.a,{onClick:function(){return o("asc"===r?"desc":"asc")},icon:"asc"===r?d.j:d.i})))}a(76),a(28);var ee=function(){return c.a.createElement("div",{className:"datasets-loading"},Object(E.a)(Array(4)).map((function(e,t){return c.a.createElement("div",{key:t,className:"dataset"},c.a.createElement("div",{className:"dataset-title animate"}),c.a.createElement("p",{className:"dataset-description animate"}),c.a.createElement("div",{className:"dataset-meta animate"}))})))},te=a(43),ae=a.n(te);function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,a=Object(n.useMemo)((function(){return Math.ceil(e.length/t)}),[e,t]),r=Object(n.useState)(0),l=Object(u.a)(r,2),o=l[0],i=l[1];Object(n.useEffect)((function(){i(0)}),[a]);var s=c.a.createElement("nav",null,c.a.createElement(ae.a,{previousLabel:"previous",nextLabel:"next",breakLabel:"...",breakClassName:"break-me",pageCount:a,onPageChange:function(e){var t=e.selected;i(t)},containerClassName:"pagination",subContainerClassName:"pages pagination",activeClassName:"active",previousClassName:"page-item",nextClassName:"page-item",pageClassName:"page-item"})),m=e.slice(o*t,(o+1)*t);return[m,{pageButtons:s}]}a(80);var ce=function(){return c.a.createElement("div",{className:""},c.a.createElement("div",{className:"filter-loading-wrapper"},Object(E.a)(Array(10)).map((function(e,t){return c.a.createElement("li",{key:t,className:"multi-buttons"},c.a.createElement("input",{type:"checkbox",disabled:!0,className:"checkbox"}),c.a.createElement("span",{className:"animate item-name"}),c.a.createElement("span",{className:"animate pill"}))}))))};a(81);function re(e){var t=e.items,a=e.selected,r=e.onChange,l=e.title,o=e.collapse,i=e.onCollapse,s=Object(n.useState)(!0),m=Object(u.a)(s,2),d=m[0],p=m[1],v=null===o?d:o,b=D(),h=Object(n.useState)(""),O=Object(u.a)(h,2),g=O[0],j=O[1],y=Object(n.useMemo)((function(){return t&&Object.keys(t)}),[t]),C=f()({data:y.map((function(e){return{name:e}})),options:{keys:["name"],shouldSort:!1,findAllMatches:!0,caseSensitive:!1}}),N=C.result,T=C.search;Object(n.useEffect)((function(){return T(g)}),[T,g]);var w=ne(Object(n.useMemo)((function(){return null===N||void 0===N?void 0:N.map((function(e){return e.name})).sort((function(e,a){return t[e]<t[a]?1:-1}))}),[N,t]),10),S=Object(u.a)(w,2),_=S[0],k=S[1].pageButtons;return c.a.createElement("div",{className:"mutli-selector"},c.a.createElement("h2",null,c.a.createElement("button",{className:"header-button",type:"button",onClick:function(){i?i(!v):p(!v)}},l," ",c.a.createElement("span",null," ",v?"+":"-")," ")),!v&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"search"},c.a.createElement("input",{disabled:!b,placeholder:"filter",value:g,onChange:function(e){return j(e.target.value)}})),c.a.createElement("ul",{className:"multi-list"},b?_.map((function(e){return c.a.createElement("li",{key:e,onClick:function(){return function(e){var t=a.includes(e)?a.filter((function(t){return t!==e})):[].concat(Object(E.a)(a),[e]);r(t)}(e)},className:"multi-buttons ".concat(a&&a.includes(e)?"selected":"")},c.a.createElement("input",{type:"checkbox",checked:a&&a.includes(e),className:"checkbox"}),c.a.createElement("span",{className:"item-name"},e),c.a.createElement("span",{className:"pill"},t[e]))})):c.a.createElement(ce,null)),k,a&&a.length>0&&c.a.createElement("button",{type:"button",onClick:function(){r([])}},"clear")))}var le=Object(n.createContext)(),oe={term:"",tags:[],categories:[],departments:[],columns:[],sortVariable:"name",sortOrder:"asc",collapseFilters:!0,collapsedFilterList:{categories:!0,tags:!0,departments:!0,columns:!0}},ie=function(e,t){var a=t.type,n=t.payload;switch(a){case"ADD_TAG":return Object(v.a)({},e,{tags:[].concat(Object(E.a)(e.tags),[n])});case"REMOVE_TAG":return Object(v.a)({},e,{tags:e.tags.filter((function(e){return e!==n}))});case"ADD_CATEGORY":return Object(v.a)({},e,{categories:[].concat(Object(E.a)(e.categories),[n])});case"REMOVE_CATEGORY":return Object(v.a)({},e,{category:e.category.filter((function(e){return e!==n}))});case"ADD_COLUMN":return Object(v.a)({},e,{columns:[].concat(Object(E.a)(e.columns),[n])});case"REMOVE_COLUMN":return Object(v.a)({},e,{columns:e.columns.filter((function(e){return e!==n}))});case"ADD_DEPARTMNET":return Object(v.a)({},e,{departments:[].concat(Object(E.a)(e.departments),[n])});case"REMOVE_DEPARTMENT":return Object(v.a)({},e,{departments:e.departments.filter((function(e){return e!==n}))});case"CLEAR":return oe;case"SET_TAGS":return Object(v.a)({},e,{tags:n});case"SET_DEPARTMENTS":return Object(v.a)({},e,{departments:n});case"SET_CATEGORIES":return Object(v.a)({},e,{categories:n});case"SET_COLUMNS":return Object(v.a)({},e,{columns:n});case"SET_SORT_ORDER":return Object(v.a)({},e,{sortOrder:n});case"SET_COLLAPSE_FILTER_BAR":return Object(v.a)({},e,{collapseFilters:n});case"SET_FILTER_STATE":return Object(v.a)({},e,{collapsedFilterList:Object(v.a)({},e.collapsedFilterList,Object(h.a)({},n.filter,n.state))});case"SET_SORT_VARIABLE":return Object(v.a)({},e,{sortVariable:n});case"SET_TERM":return Object(v.a)({},e,{term:n});default:return e}},se=function(){return Object(n.useContext)(le)};function ue(){var e=function(){var e=A();return Object(u.a)(e,1)[0].categories}(),t=function(){var e=A();return Object(u.a)(e,1)[0].tagList}(),a=function(){var e=A();return Object(u.a)(e,1)[0].departments}(),r=function(){var e=A();return Object(u.a)(e,1)[0].columns}(),l=D(),o=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].tags,n=t[1];return[a,function(e){n({type:"SET_TAGS",payload:e})}]}(),i=Object(u.a)(o,2),s=i[0],p=i[1],v=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].columns,n=t[1];return[a,function(e){n({type:"SET_COLUMNS",payload:e})}]}(),b=Object(u.a)(v,2),h=b[0],O=b[1],g=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].categories,n=t[1];return[a,function(e){n({type:"SET_CATEGORIES",payload:e})}]}(),j=Object(u.a)(g,2),y=j[0],C=j[1],N=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].departments,n=t[1];return[a,function(e){n({type:"SET_DEPARTMENTS",payload:e})}]}(),T=Object(u.a)(N,2),w=T[0],S=T[1],_=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].term,n=t[1];return[a,function(e){n({type:"SET_TERM",payload:e})}]}(),k=Object(u.a)(_,2),L=k[0],R=k[1],x=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].sortVariable,n=t[1];return[a,function(e){n({type:"SET_SORT_VARIABLE",payload:e})}]}(),I=Object(u.a)(x,2),M=I[0],F=I[1],P=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].sortOrder,n=t[1];return[a,function(e){n({type:"SET_SORT_ORDER",payload:e})}]}(),U=Object(u.a)(P,2),V=U[0],W=U[1],B=G(),Y=Object(u.a)(B,2),q=Y[0],z=Y[1],H=z.addToCollection,J=z.removeFromCollection,K=function(e){var t=e.tags,a=e.term,c=e.categories,r=e.columns,l=e.departments,o=A(),i=Object(u.a)(o,1)[0].datasets,s=f()({data:i,options:{shouldSort:!0,findAllMatches:!0,includeMatches:!0,tokenize:!0,keys:["resource.name","resource.description"],caseSensitive:!1}}),m=s.result,d=s.search;return Object(n.useEffect)((function(){d(a.toLocaleLowerCase())}),[d,a]),Object(n.useMemo)((function(){if(m){var e=m[0]&&m[0].item?m.map((function(e){return e.item})):Object(E.a)(m),a=m&&m[0]&&m[0].item?m.map((function(e){return{id:e.item.resource.id,matches:e.matches}})):[];return t&&t.length>0&&(e=e.filter((function(e){return e.classification.domain_tags.filter((function(e){return t.includes(e)})).length>0}))),c&&c.length>0&&(e=e.filter((function(e){return e.classification.categories.filter((function(e){return c.includes(e)})).length>0}))),r&&r.length>0&&(e=e.filter((function(e){return e.resource.columns_name&&e.resource.columns_name.filter((function(e){return r.includes(e)})).length>0}))),l&&l.length>0&&(e=e.filter((function(e){var t;return l.includes(null===(t=e.classification.domain_metadata.find((function(e){return"Dataset-Information_Agency"===e.key})))||void 0===t?void 0:t.value)}))),{datasets:e,matches:a.filter((function(t){return e.find((function(e){return e.resource.id===t.id}))}))}}return i}),[m,t,c,r,l,i])}({tags:s,categories:y,columns:h,term:L,departments:w}).datasets,Q=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].collapseFilters,n=t[1];return[a,function(e){n({type:"SET_COLLAPSE_FILTER_BAR",payload:e})}]}(),te=Object(u.a)(Q,2),ae=te[0],ce=te[1],le=function(){var e=se(),t=Object(u.a)(e,2),a=t[0].collapsedFilterList,n=t[1];return[a,function(e,t){n({type:"SET_FILTER_STATE",payload:{filter:e,state:t}})}]}(),oe=Object(u.a)(le,2),ie=oe[0],ue=oe[1],me=ne(function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object(n.useMemo)((function(){return c?e:e.sort((function(e,n){var c=null,r=null;switch(t){case"Name":c=e.resource.name,r=n.resource.name;break;case"Created At":c=e.resource.createdAt,r=n.resource.createdAt;break;case"Updated At":c=e.resource.updatedAt,r=n.resource.updatedAt;break;case"Downloads":c=e.resource.download_count,r=n.resource.download_count;break;case"Views":c=e.resource.page_views.page_views_total,r=n.resource.page_views.page_views_total}return(c<r?1:-1)*(a?1:-1)}))}),[c,e,t,a])}(K,M,"asc"===V,L),5),de=Object(u.a)(me,2),Ee=de[0],pe=de[1].pageButtons;return c.a.createElement("div",{className:"home-page"},c.a.createElement("div",{className:"filters ".concat(ae?"collapsed":"")},ae?c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",null,c.a.createElement("button",{onKeyDown:function(){return ce(!1)},onClick:function(){return ce(!1)},className:"header-button",type:"button"},"Filters",c.a.createElement(m.a,{icon:d.a})))):c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",{className:"filter-header"},c.a.createElement("button",{onKeyDown:function(){return ce(!0)},onClick:function(){return ce(!0)},className:"header-button",type:"button"},"Filters ",c.a.createElement(m.a,{icon:d.b}))),c.a.createElement("div",{className:"filters-scroll-area"},c.a.createElement("div",{className:"categories"},c.a.createElement(re,{items:e,onChange:C,selected:y,collapse:ie.categories,onCollapse:function(e){return ue("categories",e)},title:"Categories"})),c.a.createElement("div",{className:"departments"},c.a.createElement(re,{items:a,selected:w,onChange:S,collapse:ie.departments,onCollapse:function(e){return ue("departments",e)},title:"Departments"})),c.a.createElement("div",{className:"columns"},c.a.createElement(re,{items:r,selected:h,onChange:O,collapse:ie.columns,onCollapse:function(e){return ue("columns",e)},title:"Columns"})),c.a.createElement("div",{className:"tags"},c.a.createElement(re,{items:t,selected:s,onChange:p,collapse:ie.tags,onCollapse:function(e){return ue("tags",e)},title:"Tags"}))))),c.a.createElement("div",{className:"datasets"},c.a.createElement("div",{className:"search"},c.a.createElement(m.a,{size:"lg",icon:d.h}),c.a.createElement($.DebounceInput,{type:"text",onChange:function(e){return R(e.target.value)},value:L,debounceTimeout:300,placeholder:"Search for dataset"})),c.a.createElement("div",{className:"count-and-sort"},c.a.createElement("p",null,c.a.createElement("span",{className:"bold"},K.length)," datasets"," ",L?"sorted by relevance":""),L?null:c.a.createElement(Z,{options:["Name","Created At","Updated At","Downloads","Views"],onDirection:function(e){return W(e)},selected:M,direction:V,onSelected:function(e){return F(e)}})),c.a.createElement("ul",{className:"dataset-list"},l?Ee.map((function(e){var t;return c.a.createElement(X,{key:null===e||void 0===e?void 0:null===(t=e.resource)||void 0===t?void 0:t.id,dataset:e,inCollection:q.datasets.includes(e.resource.id),onAddToCollection:function(e){return H(q.id,e)},onRemoveFromCollection:function(e){return J(q.id,e)},query:L})})):c.a.createElement(ee,null)),c.a.createElement("div",null,pe)))}var me=a(44),de=a.n(me),Ee=(a(83),a(45));a(84);function pe(e){var t=e.rightDataset,a=e.matches,r=Object(n.useState)(!0),l=Object(u.a)(r,2),i=l[0],s=l[1],E=G(),p=Object(u.a)(E,2),f=p[0],v=p[1],b=v.addToCollection,h=v.removeFromCollection;return c.a.createElement("div",{className:"join-column"},c.a.createElement("div",{className:"join-column-row"},c.a.createElement("span",{onClick:function(){return s(!i)},onKeyDown:function(e){32===e.keycode&&s(!i)},className:"join-column-name",role:"button",tabIndex:"0"},c.a.createElement(m.a,{icon:i?d.c:d.a}),c.a.createElement(m.a,{icon:Ee.a}),t.resource.name),c.a.createElement("span",null,a?"".concat(a.length," matching ids"):"loading"),c.a.createElement("span",null,c.a.createElement(o.Link,{to:"/dataset/".concat(t.resource.id)},"View dataset")),c.a.createElement("button",{type:"button",onClick:function(){return f.datasets.includes(t.resource.id)?h(t.resource.id):b(t.resource.id)}},f.datasets.includes(t.resource.id)?"Remove dataset from collection":"Add dataset to collection")),!i&&(a?c.a.createElement("div",{className:"join-column-unique"},c.a.createElement("h3",null,"COMMON IDS"),c.a.createElement("ul",null,a.slice(0,10).map((function(e){return c.a.createElement("li",{key:e},c.a.createElement("div",{className:"bar"}),c.a.createElement(m.a,{icon:d.k}),c.a.createElement("span",null,e))}))),c.a.createElement("div",null,"and ",a.length-10," more")):c.a.createElement("h2",null,"Loading")))}a(85);function fe(e){var t=e.column,a=e.joins,r=e.dataset,l=Object(n.useState)(!0),o=Object(u.a)(l,2),i=o[0],s=o[1],p=Object(n.useState)([]),f=Object(u.a)(p,2),v=f[0],b=f[1],h=r.resource.columns_datatype[r.resource.columns_name.indexOf(t)],O=ne(v?v.sort((function(e,t){return e.matches.length<t.matches.length?1:-1})).map((function(e){return a.find((function(t){return t.dataset.resource.id===e.id}))})):a,10),g=Object(u.a)(O,2),j=g[0],y=g[1].pageButtons;return Object(n.useEffect)((function(){!1===i&&0===v.length&&a.length>0&&T(r,t).then((function(e){a.forEach((function(a){return T(a.dataset,t).then((function(t){return b((function(n){return[].concat(Object(E.a)(n),[{id:a.dataset.resource.id,matches:e.filter((function(e){return t.includes(e)}))}])}))})).catch((function(){b((function(e){return[].concat(Object(E.a)(e),[{id:a.dataset.resource.id,matches:0,error:"failed to fetch"}])}))}))}))}))}),[t,r,a,i,v]),c.a.createElement("div",{className:"column-suggestions ".concat(i?"collapsed":"")},c.a.createElement("div",{className:"table-row",role:"button",onKeyDown:function(e){36===e.keyCode&&s(!i)},onClick:function(){return s(!i)},tabIndex:"0"},c.a.createElement("span",{className:"column-collapse"},c.a.createElement(m.a,{icon:i?d.c:d.a})," ",t),c.a.createElement("span",null,h),c.a.createElement("span",null,a.length," datasets")),!i&&j&&c.a.createElement("div",{className:"columns-suggestions-matches"},c.a.createElement("h3",null,"MATCHING DATASETS"),a&&v&&c.a.createElement("ul",null,j.map((function(e){return c.a.createElement("li",{key:e.dataset.resource.id},c.a.createElement(pe,{leftDataset:r,rightDataset:e.dataset,joinCol:t,matches:v.find((function(t){return t.id===e.dataset.resource.id})).matches}))}))),y))}function ve(e){var t,a=e.dataset,r=e.joinColumns,l=(null===a||void 0===a?void 0:null===(t=a.resource)||void 0===t?void 0:t.columns_name)||[],o=Object(n.useCallback)((function(e,t){return l?t.filter((function(t){return t.joinableColumns.includes(e.toLowerCase())})):[]}),[l]),i=Object(n.useMemo)((function(){return r?l.sort((function(e,t){return o(e,r).length<o(t,r).length?1:-1})):[]}),[l,r,o]);return c.a.createElement("div",{className:"column-match-table"},c.a.createElement("div",{className:"table-header"},c.a.createElement("ul",{className:"table-row"},c.a.createElement("li",null,"Column name"),c.a.createElement("li",null,"Column type"),c.a.createElement("li",null,"# Potential joins"))),a?i.map((function(e){return c.a.createElement(fe,{dataset:a,column:e,joins:o(e,r)})})):Object(E.a)(Array(6)).map((function(e,t){return c.a.createElement("div",{key:t,className:"column-suggestions collapsed"},c.a.createElement("div",{className:"table-row",role:"button",tabIndex:"0"},c.a.createElement("span",{className:"column-collapse"},c.a.createElement(m.a,{icon:d.c})," ..."),c.a.createElement("span",{className:"animate"}," "),c.a.createElement("span",{className:"animate"}," ")))})))}a(86);var be=function(e){var t=e.currentPage;return c.a.createElement("div",{className:"Breadcrumb"},c.a.createElement(o.Link,{to:"/"},"Home"),c.a.createElement("span",null," / ",t))},he=(a(87),function(e){return de()(e).format("MMMM DD, YYYY")});function Oe(e){var t,a,r,l,o,i=e.match.params.datasetID,s=R(i),m=R(s?s.resource.parent_fxf:null),d=L(s),E=Object(n.useState)("joins"),p=Object(u.a)(E,2),f=p[0],v=p[1],b=null===s||void 0===s?void 0:s.resource,h=null===b||void 0===b?void 0:b.page_views,O=null===s||void 0===s?void 0:s.classification,g=null===O||void 0===O?void 0:O.domain_metadata,j=function(e){var t=Object(n.useState)({}),a=Object(u.a)(t,2),c=a[0],r=a[1],l=A(),o=Object(u.a)(l,1)[0].datasets;return Object(n.useEffect)((function(){fetch("".concat("/scout","/similarity_metrics.json")).then((function(e){return e.json()})).then((function(e){return r(e)}))}),[]),Object(n.useMemo)((function(){return c[e]&&o&&o.length>0?c[e].map((function(e){return{similarity:e.similarity,dataset:o.find((function(t){return t.resource.id===e.dataset}))}})):[]}),[c,e,o])}(i).filter((function(e){return e.dataset&&e.dataset.resource.id!==i})).slice(0,10),y=G(),C=Object(u.a)(y,2),N=C[0],T=C[1],w=T.addToCollection,S=T.removeFromCollection,_=null===g||void 0===g?void 0:null===(t=g.find((function(e){var t=e.key,a=e.value;return"Update_Automation"===t&&"No"===a})))||void 0===t?void 0:t.value,k=null===g||void 0===g?void 0:null===(a=g.find((function(e){return"Update_Update-Frequency"===e.key})))||void 0===a?void 0:a.value,D=null===g||void 0===g?void 0:null===(r=g.find((function(e){return"Dataset-Information_Agency"===e.key})))||void 0===r?void 0:r.value;return c.a.createElement("div",{className:"dataset-page"},c.a.createElement("div",{className:"dataset-details"},c.a.createElement("section",null,c.a.createElement(be,{currentPage:b?b.name:"..."})),c.a.createElement("section",null,c.a.createElement("h2",{className:b?"":"animate"},null===b||void 0===b?void 0:b.name),c.a.createElement("p",{className:b?"":"animate"},D),c.a.createElement(q,{className:b?"":"animate",html:null===b||void 0===b?void 0:b.description}),c.a.createElement("button",{type:"button",className:"collection-button",disabled:!b,onClick:function(){return N.datasets.includes(i)?S(i):w(i)}},N.datasets.includes(i)?"Remove From Collection":"Add to Collection"," ")),c.a.createElement("section",{className:"external-link"},c.a.createElement("p",null,"Powered by"),c.a.createElement("img",{alt:"NYC Open Data",src:"https://opendata.cityofnewyork.us/wp-content/themes/opendata-wp/assets/img/nyc-open-data-logo.svg"}),c.a.createElement(Q,{permalink:s?null===s||void 0===s?void 0:s.permalink:"#"})),c.a.createElement("section",{className:"metadata"},c.a.createElement("h2",null,"Metadata"),c.a.createElement("h3",null,"Update Automation"),c.a.createElement("p",null,_),c.a.createElement("h3",null,"Update Frequency"),c.a.createElement("p",null,k),c.a.createElement("h3",null,"Dataset Owner"),c.a.createElement("p",null,null===s||void 0===s?void 0:null===(l=s.owner)||void 0===l?void 0:l.display_name),D&&c.a.createElement(c.a.Fragment,null,c.a.createElement("h3",null,"Agency"),c.a.createElement("p",null,D)),(null===O||void 0===O?void 0:O.domain_category)&&c.a.createElement(c.a.Fragment,null,c.a.createElement("h3",null,"Category"),c.a.createElement("p",null,O.domain_category)),c.a.createElement("h3",null,"Updated"),c.a.createElement("p",null,he(null===b||void 0===b?void 0:b.updatedAt)),c.a.createElement("h3",null,"Metadata Updated at"),c.a.createElement("p",null,he(null===b||void 0===b?void 0:b.metadata_updated_at)),c.a.createElement("h3",null,"Page Views"),c.a.createElement("p",null,null===h||void 0===h?void 0:h.page_views_total))),c.a.createElement("div",{className:"dataset-recomendataions"},c.a.createElement("h2",null,"Other datasets to consider"),c.a.createElement("div",{className:"tabs"},c.a.createElement("button",{type:"button",className:"joins"===f?"active":"",onClick:function(){return v("joins")}},"Potential Join Columns"),c.a.createElement("button",{type:"button",className:"theme"===f?"active":"",onClick:function(){return v("theme")}},"Thematically Similar")),"joins"===f&&(s&&"dataset"!==(null===s||void 0===s?void 0:null===(o=s.resource)||void 0===o?void 0:o.type)?function(e,t){var a,n,r;return t?c.a.createElement("p",{className:"intro"},"This dataset is actually a view of dataset"," ",null===t||void 0===t?void 0:null===(r=t.resource)||void 0===r?void 0:r.name):"file"===(null===e||void 0===e?void 0:null===(a=e.resource)||void 0===a?void 0:a.type)?c.a.createElement("p",{className:"intro"},"This resource points of a file which we currently don't have the ability to analyse. We are working to bring more types of data to Scout. Check back shortly"):"href"===(null===e||void 0===e?void 0:null===(n=e.resource)||void 0===n?void 0:n.type)?c.a.createElement("p",{className:"intro"},"This resource is actually just a link to a website resource. We currently dont have the ability to provide information on such resources"):c.a.createElement("p",{className:"intro"},"We currently dont have the ability to analyse this dataset.")}(s,m):c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"intro"},"Find datasets that share a column with the current dataset.")," ",c.a.createElement("p",null," ","These columns might be interesting datasets to join with the current dataset to add additional details or bring in context"),c.a.createElement(ve,{dataset:s,joinColumns:d}))),"theme"===f&&c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,"Dataset that are thematically similar based on name and description"),c.a.createElement("div",{className:"dataset-recomendataions-theme-list"},null===j||void 0===j?void 0:j.map((function(e){return c.a.createElement(X,{onAddToCollection:w,onRemoveFromCollection:S,dataset:e.dataset,similarity:e.similarity,inCollection:N.datasets.includes(e.dataset.resource.id)})}))))))}a(88);var ge=a(98),je=a(99),ye=a(100),Ce=a(101),Ne=a(102),Te=a(103),we=function(e){var t;return g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!navigator.clipboard){a.next=9;break}return a.prev=1,a.next=4,g.a.awrap(navigator.clipboard.writeText(e));case 4:return a.abrupt("return",!0);case 7:a.prev=7,a.t0=a.catch(1);case 9:if(!document.queryCommandSupported||!document.queryCommandSupported("copy")){a.next=26;break}return(t=document.createElement("textarea")).style.opacity="0",t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select(),a.prev=16,a.abrupt("return",document.execCommand("copy"));case 20:return a.prev=20,a.t1=a.catch(16),a.abrupt("return",!1);case 23:return a.prev=23,document.body.removeChild(t),a.finish(23);case 26:return a.abrupt("return",!1);case 27:case"end":return a.stop()}}),null,null,[[1,7],[16,20,23,26]])};function Se(e){var t=e.match.params,a=t.name,r=t.datasetIDs,l=window.location.href,o=x(r.split(",")),i=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),c=a[0],r=a[1];return[c,function(){return g.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.awrap(we(e));case 2:r(!0);case 3:case"end":return t.stop()}}))}]}(l),s=Object(u.a)(i,2),m=s[0],d=s[1];return c.a.createElement("div",{className:"collections-page"},c.a.createElement("div",{className:"collections-details"},c.a.createElement("section",null,c.a.createElement(be,{currentPage:"Collections"})),c.a.createElement("section",null,c.a.createElement("h2",null,a),c.a.createElement("p",null,o.length," dataset",o.length>1?"s":"")),c.a.createElement("div",null,c.a.createElement("h3",null,"Share this collection:"),c.a.createElement("p",{className:"dataset-url"},l," "),c.a.createElement("button",{type:"button",onClick:d},"Copy link"),c.a.createElement("span",null,m?"Copied!":" "," "),c.a.createElement("p",{className:"share-icons"},c.a.createElement(ge.a,{url:l},c.a.createElement(je.a,{size:36}))," ",c.a.createElement(ye.a,{url:l},c.a.createElement(Ce.a,{size:36})),c.a.createElement(Ne.a,{url:l},c.a.createElement(Te.a,{size:36}))))),c.a.createElement("div",{className:"collections-content"},o.map((function(e){return c.a.createElement(X,{viewInOpenPortal:!0,key:e.id,dataset:e})}))))}a(92);function _e(){return c.a.createElement("div",{className:"about-page"},c.a.createElement("section",null,c.a.createElement("h1",null,"Scout"),c.a.createElement("section",null,c.a.createElement("h2",null,"What is Scout?"),c.a.createElement("p",null,"Scout is a tool to make it easier to navigate Open Data Portals and find groups of related datasets. It sits on top of Socrata Open Data portals and provides tools that augment those data portals and make more obscure datasets more descoverable")),c.a.createElement("section",null,c.a.createElement("h2",null,"What cities does Scout support?"),c.a.createElement("p",null,"Scout currently only works with the New York City open data portal, however we are planning to release versions for other cities in the near future. In addition we are planning on making suggestions for datasets from other citie.")),c.a.createElement("section",null,c.a.createElement("h2",null,"How do the thematically similar recomendations work?"),c.a.createElement("p",null,"Scout tries to surface datasets that have a similar theme to the one you are currently looking at. It does this using a technique called Doc2Vec which builds a mapping of each of the dataset names and descriptions and uses these mappings to find documents that have a similar meaning.")),c.a.createElement("section",null,c.a.createElement("h2",null,"How can I contribute to Scout?"),c.a.createElement("p",null,"Scout is a tool to make it easier to navigate Open Data Portals and find groups of related datasets. It sits on top of Socrata Open Data portals and provides tools that augment those data portals and make more obscure datasets more descoverable"))),c.a.createElement("section",null,c.a.createElement("h1",null,"Data Clinic"),c.a.createElement("section",null,c.a.createElement("h2",null,"What is the Data Clinic?"),c.a.createElement("p",null,"We bring Two Sigma\u2019s people, data science skills, and technological know-how to help our partners to use data and tech more effectively."),c.a.createElement("p",null,"We share our scientific process and source the right talent from within Two Sigma to address your unique challenges."),c.a.createElement("p",null,"We can help optimize and automate daily operations, translate data into insights, or demonstrate potential for even greater change in the service of your community."))),c.a.createElement("section",null,c.a.createElement("h1",null,"Two Sigma"),c.a.createElement("section",null,c.a.createElement("h2",null,"What is Two Sigma?"),c.a.createElement("p",null,"We\u2019re not your typical investment manager. We follow principles of technology and innovation as much as principles of investment management. Fields like machine learning and distributed computing guide us. Since 2001, we\u2019ve searched for ways that these kinds of technologies can make us better at what we do. We never stop researching and developing."),c.a.createElement("p",null,"In the process, we work to help real people. Through our investors, we support the retirements of millions around the world. And we help fund breakthrough research, education and a wide range of charities and foundations."))))}a(93);function ke(){var e=G(),t=Object(u.a)(e,2),a=t[0],n=t[1],r=n.clearCollection,l=n.setName,i=x(a.datasets);return c.a.createElement("div",{className:"create-collection-modal"},c.a.createElement("h3",null,"Create collection with the following datasets"),c.a.createElement("ul",null,i.map((function(e){return c.a.createElement("li",null,e.resource.name)}))),c.a.createElement("input",{type:"text",placeholder:"Name",value:a.name,onChange:function(e){return l(e.target.value)}}),c.a.createElement(o.Link,{to:"/collection/".concat(a.name,"/").concat(a.datasets.join(","))},c.a.createElement("button",{type:"submit",onClick:r},"Create")))}a(94);function Ae(){var e=function(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),l=Object(u.a)(r,2),o=l[0],i=l[1];return Object(n.useEffect)((function(){c(window.localStorage.getItem("seenWelcome")),i(!0)}),[]),[a,o,function(){c(!0),window.localStorage.setItem("seenWelcome",!0)}]}(),t=Object(u.a)(e,3),a=t[0],r=t[1],l=t[2];return!a&&r&&c.a.createElement(s.Modal,{onBackdropClick:function(){l()}},c.a.createElement("div",{className:"welcome-modal"},c.a.createElement("h2",null,"Welcome to Scout!"),c.a.createElement("p",null,"Thanks for trying Scout. Scout is a new way to browse open data portals. It is built with discoverability in mind. To learn more, click the about button. To get started, try searching for a dataset or select a dataset to see recomendations."),c.a.createElement("p",null,"You can also create collections of datasets which you can share with others. To do so start collecting or click on the collections tab")))}function De(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e=sessionStorage.redirect;if(delete sessionStorage.redirect,e&&e!==window.location.href){var t=e;t="/".concat(t.split("/").slice(4).join("/")),r(t)}}),[]),a?c.a.createElement(i.c,{to:a}):c.a.createElement(c.a.Fragment,null)}a(95);var Le=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(o.BrowserRouter,{basename:"/scout"},c.a.createElement(s.ModalContainer,null),c.a.createElement(K,null),c.a.createElement("div",{className:"content"},c.a.createElement(i.g,null,c.a.createElement(i.d,{path:"/dataset/:datasetID",component:Oe}),c.a.createElement(i.d,{path:"/collection/:name/:datasetIDs",component:Se}),c.a.createElement(i.d,{path:"/about",component:_e}),c.a.createElement(s.ModalRoute,{path:"/collection/new",parentPath:"/",component:ke}),c.a.createElement(i.d,{path:"/",component:ue}),c.a.createElement(i.c,{from:"/",to:"/"}))),c.a.createElement(De,null),c.a.createElement(Ae,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement((function(e){var t=e.children,a=Object(n.useReducer)(k,_),r=Object(u.a)(a,2),l=r[0],o=r[1];Object(n.useEffect)((function(){console.log("state is ",l)}),[l]),Object(n.useEffect)((function(){w.SocrataCache.get(1).then((function(e){if(e){var t=JSON.parse(e.data);o({type:"HYDRATE_STATE",payload:Object(v.a)({},_,{},t,{cache_loaded:!0})}),o({type:"SET_LOADED"})}else(function(){var e,t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(y(0,1));case 2:return e=n.sent,t=e.resultSetSize,a=Math.ceil(t/100),n.abrupt("return",Promise.all(Object(E.a)(Array(a)).map((function(e,t){return y(t).then((function(e){return e.results}))}))).then((function(e){return e.reduce((function(e,t){return[].concat(Object(E.a)(t),Object(E.a)(e))}),[])})));case 6:case"end":return n.stop()}}))})().then((function(e){var t=function(e){var t={};return e.forEach((function(e){e.classification.domain_tags&&e.classification.domain_tags.forEach((function(e){e in t?t[e]+=1:t[e]=1}))})),t}(e),a=function(e){return e.reduce((function(e,t){return[].concat(Object(E.a)(e),Object(E.a)(t.classification.categories?t.classification.categories:[]))}),[]).reduce((function(e,t){return t in e?Object(v.a)({},e,Object(h.a)({},t,e[t]+1)):Object(v.a)({},e,Object(h.a)({},t,1))}),{})}(e),n=function(e){return e.map((function(e){return e.classification.domain_metadata.find((function(e){return"Dataset-Information_Agency"===e.key}))})).filter((function(e){return e})).map((function(e){return e.value})).reduce((function(e,t){return t in e?Object(v.a)({},e,Object(h.a)({},t,e[t]+1)):Object(v.a)({},e,Object(h.a)({},t,1))}),{})}(e),c=function(e){var t={};return e.forEach((function(e){e.resource.columns_name&&e.resource.columns_name.forEach((function(e){e in t?t[e]+=1:t[e]=1}))})),t}(e);o({type:"UPDATE_OPEN_DATASET_MANIFEST",payload:e}),o({type:"UPDATE_TAGS",payload:t}),o({type:"UPDATE_CATEGORIES",payload:a}),o({type:"UPDATE_DEPARTMENTS",payload:n}),o({type:"UPDATE_COLUMNS",payload:c}),o({type:"SET_LOADED"})}))}))}),[]);var i=l.datasets,s=l.tagList,m=l.columns,d=l.categories,p=l.departments,f=l.stateLoaded;return Object(n.useEffect)((function(){f&&(console.log("writing cache"),w.SocrataCache.put({data:JSON.stringify({datasets:i,tagList:s,categories:d,departments:p,columns:m}),id:1}))}),[i,s,d,m,p,f]),c.a.createElement(S.Provider,{value:[l,o]},t)}),null,c.a.createElement((function(e){var t=e.children,a=Object(n.useReducer)(ie,oe),r=Object(u.a)(a,2),l=r[0],o=r[1];return c.a.createElement(le.Provider,{value:[l,o]},t)}),null,c.a.createElement((function(e){var t=e.children,a=Object(n.useReducer)(V,P),r=Object(u.a)(a,2),l=r[0],o=r[1],i=l.cacheLoaded,s=l.collections,m=l.activeCollectionID;return Object(n.useEffect)((function(){U.CollectionCache.get(1).then((function(e){if(e){var t=JSON.parse(e.data);o({type:"HYDRATE_STATE",payload:Object(v.a)({},P,{},t,{cacheLoaded:!0})})}else o({payload:Object(v.a)({},P,{cacheLoaded:!0}),type:"HYDRATE_STATE"})}))}),[]),Object(n.useEffect)((function(){i&&U.CollectionCache.put({data:JSON.stringify({collections:s,activeCollectionID:m}),id:1})}),[i,s,m]),c.a.createElement(F.Provider,{value:[l,o]},t)}),null,c.a.createElement(Le,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[47,1,2]]]);
//# sourceMappingURL=main.e0bcd169.chunk.js.map